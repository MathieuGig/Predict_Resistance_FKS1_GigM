for (i in DataAni$X)
{
MedianSelectionCoeffAni <- append(MedianSelectionCoeffAni, DataAni$median_s[DataAni$X == i])
MedianSelectionCoeffCaspo <- append(MedianSelectionCoeffCaspo, DataCaspo$median_s[DataCaspo$X == i])
MedianSelectionCoeffMica <- append(MedianSelectionCoeffMica, DataMica$median_s[DataMica$X == i])
AASequence <- append(AASequence, DataAni$aa_seq[DataAni$X == i])
MutationAA <- append(MutationAA, DataAni$Nham_aa[DataAni$X == i])
}
MutationAA <- as.factor(MutationAA)
## Make new data frame.
NewData <- data.frame(Anidulafungin = MedianSelectionCoeffAni,
Caspofungin = MedianSelectionCoeffCaspo,
Micafungin = MedianSelectionCoeffMica,
MutatedAminoAcids = MutationAA,
Sequence = AASequence)
BestData <- unique(NewData)
library(ggplot2)
library(GGally)
library(cowplot)
graphCutOff <- 4
LabelCutOff <- 1
Graph1 <- ggplot(BestData, aes(Anidulafungin, Caspofungin,
color = MutatedAminoAcids,
label = ifelse((Anidulafungin > LabelCutOff & Caspofungin < LabelCutOff) | (Anidulafungin < LabelCutOff & Caspofungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
Graph2 <- ggplot(BestData, aes(Anidulafungin, Micafungin,
color = MutatedAminoAcids,
label = ifelse((Anidulafungin > LabelCutOff & Micafungin < LabelCutOff) | (Anidulafungin < LabelCutOff & Micafungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
Graph3 <- ggplot(BestData, aes(Micafungin, Caspofungin,
color = MutatedAminoAcids,
label = ifelse((Micafungin > LabelCutOff & Caspofungin < LabelCutOff) | (Micafungin < LabelCutOff & Caspofungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
title <- ggdraw() +
draw_label(
paste(sample, "_", gene, "-", hotspot,sep = ""),
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 97)
)
plot_grid(title, Graph1, Graph3, Graph2)
#ggsave(paste("pairPlot_", nameOfFile, ".png", sep = ""), width = 10, height = 10)
}
makeComparisonPlot("BY4741", "FKS1", "HS1")
makeComparisonPlot("BY4741", "FKS1", "HS2")
makeComparisonPlot("R1158", "FKS1", "HS1")
makeComparisonPlot("R1158", "FKS1", "HS2")
makeComparisonPlot("R1158", "FKS2", "HS1")
makeComparisonPlot("R1158", "FKS2", "HS2")
makeComparisonPlot <- function(sample, gene, hotspot)
{
drug <- c("anidulafungin", "caspofungin", "micafungin")
nameOfFile <- paste(sample, "_", gene, "-", hotspot, "_single_ortho_", sep = "")
File <- paste(getwd(), "processed_data", paste(nameOfFile, drug, sep = ""),
"selcoeff_all_libraries.csv", sep = "/")
Readfile <- list()
for (i in File)
{
Readfile <- append(Readfile, list(read.csv(i)))
}
DataAni <- subset(Readfile[[1]], Readfile[[1]]$seq_type == "ortho")
DataCaspo <- subset(Readfile[[2]], Readfile[[2]]$seq_type == "ortho")
DataMica <- subset(Readfile[[3]], Readfile[[3]]$seq_type == "ortho")
## Compute median sel_coeffs.
MedianSelectionCoeffAni <- c()
MedianSelectionCoeffCaspo <- c()
MedianSelectionCoeffMica <- c()
MutationAA <- c()
AASequence <- c()
for (i in DataAni$X)
{
MedianSelectionCoeffAni <- append(MedianSelectionCoeffAni, DataAni$median_s[DataAni$X == i])
MedianSelectionCoeffCaspo <- append(MedianSelectionCoeffCaspo, DataCaspo$median_s[DataCaspo$X == i])
MedianSelectionCoeffMica <- append(MedianSelectionCoeffMica, DataMica$median_s[DataMica$X == i])
AASequence <- append(AASequence, DataAni$aa_seq[DataAni$X == i])
MutationAA <- append(MutationAA, DataAni$Nham_aa[DataAni$X == i])
}
MutationAA <- as.factor(MutationAA)
## Make new data frame.
NewData <- data.frame(Anidulafungin = MedianSelectionCoeffAni,
Caspofungin = MedianSelectionCoeffCaspo,
Micafungin = MedianSelectionCoeffMica,
MutatedAminoAcids = MutationAA,
Sequence = AASequence)
BestData <- unique(NewData)
library(ggplot2)
library(GGally)
library(cowplot)
origin <- 0
LabelCutOff <- 1
Graph1 <- ggplot(BestData, aes(Anidulafungin, Caspofungin,
color = MutatedAminoAcids,
label = ifelse((Anidulafungin > LabelCutOff & Caspofungin < origin) | (Anidulafungin < origin & Caspofungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
Graph2 <- ggplot(BestData, aes(Anidulafungin, Micafungin,
color = MutatedAminoAcids,
label = ifelse((Anidulafungin > LabelCutOff & Micafungin < origin) | (Anidulafungin < origin & Micafungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
Graph3 <- ggplot(BestData, aes(Micafungin, Caspofungin,
color = MutatedAminoAcids,
label = ifelse((Micafungin > LabelCutOff & Caspofungin < origin) | (Micafungin < origin & Caspofungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
title <- ggdraw() +
draw_label(
paste(sample, "_", gene, "-", hotspot,sep = ""),
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 97)
)
plot_grid(title, Graph1, Graph3, Graph2)
#ggsave(paste("pairPlot_", nameOfFile, ".png", sep = ""), width = 10, height = 10)
}
makeComparisonPlot("BY4741", "FKS1", "HS1")
makeComparisonPlot("BY4741", "FKS1", "HS2")
makeComparisonPlot("R1158", "FKS1", "HS1")
makeComparisonPlot("R1158", "FKS1", "HS2")
makeComparisonPlot("R1158", "FKS2", "HS1")
makeComparisonPlot("R1158", "FKS2", "HS2")
makeComparisonPlot <- function(sample, gene, hotspot)
{
drug <- c("anidulafungin", "caspofungin", "micafungin")
nameOfFile <- paste(sample, "_", gene, "-", hotspot, "_single_ortho_", sep = "")
File <- paste(getwd(), "processed_data", paste(nameOfFile, drug, sep = ""),
"selcoeff_all_libraries.csv", sep = "/")
Readfile <- list()
for (i in File)
{
Readfile <- append(Readfile, list(read.csv(i)))
}
DataAni <- subset(Readfile[[1]], Readfile[[1]]$seq_type == "ortho")
DataCaspo <- subset(Readfile[[2]], Readfile[[2]]$seq_type == "ortho")
DataMica <- subset(Readfile[[3]], Readfile[[3]]$seq_type == "ortho")
## Compute median sel_coeffs.
MedianSelectionCoeffAni <- c()
MedianSelectionCoeffCaspo <- c()
MedianSelectionCoeffMica <- c()
MutationAA <- c()
AASequence <- c()
for (i in DataAni$X)
{
MedianSelectionCoeffAni <- append(MedianSelectionCoeffAni, DataAni$median_s[DataAni$X == i])
MedianSelectionCoeffCaspo <- append(MedianSelectionCoeffCaspo, DataCaspo$median_s[DataCaspo$X == i])
MedianSelectionCoeffMica <- append(MedianSelectionCoeffMica, DataMica$median_s[DataMica$X == i])
AASequence <- append(AASequence, DataAni$aa_seq[DataAni$X == i])
MutationAA <- append(MutationAA, DataAni$Nham_aa[DataAni$X == i])
}
MutationAA <- as.factor(MutationAA)
## Make new data frame.
NewData <- data.frame(Anidulafungin = MedianSelectionCoeffAni,
Caspofungin = MedianSelectionCoeffCaspo,
Micafungin = MedianSelectionCoeffMica,
MutatedAminoAcids = MutationAA,
Sequence = AASequence)
BestData <- unique(NewData)
library(ggplot2)
library(GGally)
library(cowplot)
origin <- 0
LabelCutOff <- 1
Graph1 <- ggplot(BestData, aes(Anidulafungin, Caspofungin,
color = MutatedAminoAcids,
label = ifelse((Anidulafungin > LabelCutOff & Caspofungin < origin) | (Anidulafungin < origin & Caspofungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
Graph2 <- ggplot(BestData, aes(Anidulafungin, Micafungin,
color = MutatedAminoAcids,
label = ifelse((Anidulafungin > LabelCutOff & Micafungin < origin) | (Anidulafungin < origin & Micafungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
Graph3 <- ggplot(BestData, aes(Micafungin, Caspofungin,
color = MutatedAminoAcids,
label = ifelse((Micafungin > LabelCutOff & Caspofungin < origin) | (Micafungin < origin & Caspofungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
title <- ggdraw() +
draw_label(
paste(sample, "_", gene, "-", hotspot,sep = ""),
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 97)
)
plot_grid(title, Graph1, Graph3, Graph2)
ggsave(paste("pairPlot_", nameOfFile, ".png", sep = ""), width = 10, height = 10)
}
makeComparisonPlot("BY4741", "FKS1", "HS1")
makeComparisonPlot("BY4741", "FKS1", "HS2")
makeComparisonPlot("R1158", "FKS1", "HS1")
makeComparisonPlot("R1158", "FKS1", "HS2")
makeComparisonPlot("R1158", "FKS2", "HS1")
makeComparisonPlot("R1158", "FKS2", "HS2")
###
### makeBoxplot(sample, gene, hotspot, drug)
###
##
## Generates a boxplot graph using ggplot and the DMS data.
##
##
## Arguments
##
## sample: character string, the name of the analysed sample.
## gene: character string, the name of the analysed gene.
## hotspot: character string, HS1 or HS2.
## drug: character string, the name of the antifungal drug.
##
##
## Value
##
## A boxplot graph representing the median selection coefficient as a function
## of the number of mutated amino acids.
##
##
## Example
##
## makeBoxplot("BY4741", "FKS1", "HS1" "anidulafungin")
##
makeBoxplot <- function(sample, gene, hotspot, drug)
{
# Validation of arguments
stopifnot("Invalid sample" = sample %in% c("BY4741", "R1158"))
stopifnot("Invalid gene" = gene %in% c("FKS1", "FKS2"))
stopifnot("Invalid hotspot" = hotspot %in% c("HS1", "HS2"))
stopifnot("Invalid drug" = drug %in% c("anidulafungin", "caspofungin", "micafungin"))
# Import data from file
File <- paste(getwd(), "processed_data", paste(sample, "_", gene, "-", hotspot, "_single_ortho_", drug, sep = ""), "selcoeff_all_libraries.csv", sep = "/")
Readfile <- read.csv(File)
BigData <- subset(Readfile, Readfile$seq_type == "ortho")
Naa <- c()
SelectionCoeff <- c()
# Make simpler data frame from the imported data.
for (i in BigData$X)
{
Naa <- append(Naa, BigData$Nham_aa[BigData$X == i])
#SelectionCoeff <- append(SelectionCoeff, median(c(BigData$selcoeff_1[BigData$X ==  i], BigData$selcoeff_2[BigData$X == i])))
SelectionCoeff <- append(SelectionCoeff, BigData$median_s[BigData$X == i])
}
Naa <- as.factor(Naa)
NewData <- data.frame(MutatedAminoAcids = Naa, SelectionCoeff)
BestData <- unique(NewData)
# Load library to make graphs.
library(ggplot2)
# Custom graph title
graphTitle <- paste(sample, "_", gene, "-", hotspot, "_single_ortho_", drug, sep = "")
# Make Graph where x axis = Naa.
GraphNaa <- ggplot(data = BestData, aes(x = MutatedAminoAcids, y = SelectionCoeff)) +
geom_boxplot(fill = "cyan")+ geom_jitter(position = position_jitter(0.2)) +
labs(title = graphTitle)
#+ ylim(-4, 4)
# Return graph
GraphNaa
}
### Testing
makeBoxplot("BY4741", "FKS1", "HS1", "anidulafungin")
makeBoxplot("BY4741", "FKS1", "HS1", "caspofungin")
makeBoxplot("BY4741", "FKS1", "HS1", "micafungin")
makeBoxplot("BY4741", "FKS1", "HS2", "anidulafungin")
makeBoxplot("BY4741", "FKS1", "HS2", "caspofungin")
makeBoxplot("BY4741", "FKS1", "HS2", "micafungin")
makeBoxplot("R1158", "FKS1", "HS1", "anidulafungin")
makeBoxplot("R1158", "FKS1", "HS1", "caspofungin")
makeBoxplot("R1158", "FKS1", "HS1", "micafungin")
makeBoxplot("R1158", "FKS1", "HS2", "anidulafungin")
makeBoxplot("R1158", "FKS1", "HS2", "caspofungin")
makeBoxplot("R1158", "FKS1", "HS2", "micafungin")
makeBoxplot("R1158", "FKS2", "HS1", "anidulafungin")
makeBoxplot("R1158", "FKS2", "HS1", "caspofungin")
makeBoxplot("R1158", "FKS2", "HS1", "micafungin")
makeBoxplot("R1158", "FKS2", "HS2", "anidulafungin")
makeBoxplot("R1158", "FKS2", "HS2", "caspofungin")
makeBoxplot("R1158", "FKS2", "HS2", "micafungin")
###
### makeBoxplot(sample, gene, hotspot, drug)
###
##
## Generates a boxplot graph using ggplot and the DMS data.
##
##
## Arguments
##
## sample: character string, the name of the analysed sample.
## gene: character string, the name of the analysed gene.
## hotspot: character string, HS1 or HS2.
## drug: character string, the name of the antifungal drug.
##
##
## Value
##
## A boxplot graph representing the median selection coefficient as a function
## of the number of mutated amino acids.
##
##
## Example
##
## makeBoxplot("BY4741", "FKS1", "HS1" "anidulafungin")
##
makeBoxplot <- function(sample, gene, hotspot, drug)
{
# Validation of arguments
stopifnot("Invalid sample" = sample %in% c("BY4741", "R1158"))
stopifnot("Invalid gene" = gene %in% c("FKS1", "FKS2"))
stopifnot("Invalid hotspot" = hotspot %in% c("HS1", "HS2"))
stopifnot("Invalid drug" = drug %in% c("anidulafungin", "caspofungin", "micafungin"))
# Import data from file
File <- paste(getwd(), "processed_data", paste(sample, "_", gene, "-", hotspot, "_single_ortho_", drug, sep = ""), "selcoeff_all_libraries.csv", sep = "/")
Readfile <- read.csv(File)
BigData <- subset(Readfile, Readfile$seq_type == "ortho")
Naa <- c()
SelectionCoeff <- c()
# Make simpler data frame from the imported data.
for (i in BigData$X)
{
Naa <- append(Naa, BigData$Nham_aa[BigData$X == i])
#SelectionCoeff <- append(SelectionCoeff, median(c(BigData$selcoeff_1[BigData$X ==  i], BigData$selcoeff_2[BigData$X == i])))
SelectionCoeff <- append(SelectionCoeff, BigData$median_s[BigData$X == i])
}
Naa <- as.factor(Naa)
NewData <- data.frame(MutatedAminoAcids = Naa, SelectionCoeff)
BestData <- unique(NewData)
# Load library to make graphs.
library(ggplot2)
# Custom graph title
graphTitle <- paste(sample, "_", gene, "-", hotspot, "_single_ortho_", drug, sep = "")
# Make Graph where x axis = Naa.
GraphNaa <- ggplot(data = BestData, aes(x = MutatedAminoAcids, y = SelectionCoeff)) +
geom_boxplot(fill = "cyan")+ geom_jitter(position = position_jitter(0.2)) +
labs(title = graphTitle) + ylim(-1, 3)
# Return graph
GraphNaa
}
### Testing
makeBoxplot("BY4741", "FKS1", "HS1", "anidulafungin")
makeBoxplot("BY4741", "FKS1", "HS1", "caspofungin")
makeBoxplot("BY4741", "FKS1", "HS1", "micafungin")
makeBoxplot("BY4741", "FKS1", "HS2", "anidulafungin")
makeBoxplot("BY4741", "FKS1", "HS2", "caspofungin")
makeBoxplot("BY4741", "FKS1", "HS2", "micafungin")
makeBoxplot("R1158", "FKS1", "HS1", "anidulafungin")
makeBoxplot("R1158", "FKS1", "HS1", "caspofungin")
makeBoxplot("R1158", "FKS1", "HS1", "micafungin")
makeBoxplot("R1158", "FKS1", "HS2", "anidulafungin")
makeBoxplot("R1158", "FKS1", "HS2", "caspofungin")
makeBoxplot("R1158", "FKS1", "HS2", "micafungin")
makeBoxplot("R1158", "FKS2", "HS1", "anidulafungin")
makeBoxplot("R1158", "FKS2", "HS1", "caspofungin")
makeBoxplot("R1158", "FKS2", "HS1", "micafungin")
makeBoxplot("R1158", "FKS2", "HS2", "anidulafungin")
makeBoxplot("R1158", "FKS2", "HS2", "caspofungin")
makeBoxplot("R1158", "FKS2", "HS2", "micafungin")
###
### makeBoxplot(sample, gene, hotspot, drug)
###
##
## Generates a boxplot graph using ggplot and the DMS data.
##
##
## Arguments
##
## sample: character string, the name of the analysed sample.
## gene: character string, the name of the analysed gene.
## hotspot: character string, HS1 or HS2.
## drug: character string, the name of the antifungal drug.
##
##
## Value
##
## A boxplot graph representing the median selection coefficient as a function
## of the number of mutated amino acids.
##
##
## Example
##
## makeBoxplot("BY4741", "FKS1", "HS1" "anidulafungin")
##
makeBoxplot <- function(sample, gene, hotspot, drug)
{
# Validation of arguments
stopifnot("Invalid sample" = sample %in% c("BY4741", "R1158"))
stopifnot("Invalid gene" = gene %in% c("FKS1", "FKS2"))
stopifnot("Invalid hotspot" = hotspot %in% c("HS1", "HS2"))
stopifnot("Invalid drug" = drug %in% c("anidulafungin", "caspofungin", "micafungin"))
# Import data from file
File <- paste(getwd(), "processed_data", paste(sample, "_", gene, "-", hotspot, "_single_ortho_", drug, sep = ""), "selcoeff_all_libraries.csv", sep = "/")
Readfile <- read.csv(File)
BigData <- subset(Readfile, Readfile$seq_type == "ortho")
Naa <- c()
SelectionCoeff <- c()
# Make simpler data frame from the imported data.
for (i in BigData$X)
{
Naa <- append(Naa, BigData$Nham_aa[BigData$X == i])
#SelectionCoeff <- append(SelectionCoeff, median(c(BigData$selcoeff_1[BigData$X ==  i], BigData$selcoeff_2[BigData$X == i])))
SelectionCoeff <- append(SelectionCoeff, BigData$median_s[BigData$X == i])
}
Naa <- as.factor(Naa)
NewData <- data.frame(MutatedAminoAcids = Naa, SelectionCoeff)
BestData <- unique(NewData)
# Load library to make graphs.
library(ggplot2)
# Custom graph title
graphTitle <- paste(sample, "_", gene, "-", hotspot, "_single_ortho_", drug, sep = "")
# Make Graph where x axis = Naa.
GraphNaa <- ggplot(data = BestData, aes(x = MutatedAminoAcids, y = SelectionCoeff)) +
geom_boxplot(fill = "cyan")+ geom_jitter(position = position_jitter(0.2)) +
labs(title = graphTitle) + ylim(-2, 4)
# Return graph
GraphNaa
}
### Testing
makeBoxplot("BY4741", "FKS1", "HS1", "anidulafungin")
makeBoxplot("BY4741", "FKS1", "HS1", "caspofungin")
makeBoxplot("BY4741", "FKS1", "HS1", "micafungin")
makeBoxplot("BY4741", "FKS1", "HS2", "anidulafungin")
makeBoxplot("BY4741", "FKS1", "HS2", "caspofungin")
makeBoxplot("BY4741", "FKS1", "HS2", "micafungin")
makeBoxplot("R1158", "FKS1", "HS1", "anidulafungin")
makeBoxplot("R1158", "FKS1", "HS1", "caspofungin")
makeBoxplot("R1158", "FKS1", "HS1", "micafungin")
makeBoxplot("R1158", "FKS1", "HS2", "anidulafungin")
makeBoxplot("R1158", "FKS1", "HS2", "caspofungin")
makeBoxplot("R1158", "FKS1", "HS2", "micafungin")
makeBoxplot("R1158", "FKS2", "HS1", "anidulafungin")
makeBoxplot("R1158", "FKS2", "HS1", "caspofungin")
makeBoxplot("R1158", "FKS2", "HS1", "micafungin")
makeBoxplot("R1158", "FKS2", "HS2", "anidulafungin")
makeBoxplot("R1158", "FKS2", "HS2", "caspofungin")
makeBoxplot("R1158", "FKS2", "HS2", "micafungin")
makeComparisonPlot <- function(sample, gene, hotspot)
{
drug <- c("anidulafungin", "caspofungin", "micafungin")
nameOfFile <- paste(sample, "_", gene, "-", hotspot, "_single_ortho_", sep = "")
File <- paste(getwd(), "processed_data", paste(nameOfFile, drug, sep = ""),
"selcoeff_all_libraries.csv", sep = "/")
Readfile <- list()
for (i in File)
{
Readfile <- append(Readfile, list(read.csv(i)))
}
DataAni <- subset(Readfile[[1]], Readfile[[1]]$seq_type == "ortho")
DataCaspo <- subset(Readfile[[2]], Readfile[[2]]$seq_type == "ortho")
DataMica <- subset(Readfile[[3]], Readfile[[3]]$seq_type == "ortho")
## Compute median sel_coeffs.
MedianSelectionCoeffAni <- c()
MedianSelectionCoeffCaspo <- c()
MedianSelectionCoeffMica <- c()
MutationAA <- c()
AASequence <- c()
for (i in DataAni$X)
{
MedianSelectionCoeffAni <- append(MedianSelectionCoeffAni, DataAni$median_s[DataAni$X == i])
MedianSelectionCoeffCaspo <- append(MedianSelectionCoeffCaspo, DataCaspo$median_s[DataCaspo$X == i])
MedianSelectionCoeffMica <- append(MedianSelectionCoeffMica, DataMica$median_s[DataMica$X == i])
AASequence <- append(AASequence, DataAni$aa_seq[DataAni$X == i])
MutationAA <- append(MutationAA, DataAni$Nham_aa[DataAni$X == i])
}
MutationAA <- as.factor(MutationAA)
## Make new data frame.
NewData <- data.frame(Anidulafungin = MedianSelectionCoeffAni,
Caspofungin = MedianSelectionCoeffCaspo,
Micafungin = MedianSelectionCoeffMica,
MutatedAminoAcids = MutationAA,
Sequence = AASequence)
BestData <- unique(NewData)
library(ggplot2)
library(GGally)
library(cowplot)
origin <- 0
LabelCutOff <- 1
Graph1 <- ggplot(BestData, aes(Anidulafungin, Caspofungin,
color = MutatedAminoAcids,
label = ifelse((Anidulafungin > LabelCutOff & Caspofungin < origin) | (Anidulafungin < origin & Caspofungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
Graph2 <- ggplot(BestData, aes(Anidulafungin, Micafungin,
color = MutatedAminoAcids,
label = ifelse((Anidulafungin > LabelCutOff & Micafungin < origin) | (Anidulafungin < origin & Micafungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
Graph3 <- ggplot(BestData, aes(Micafungin, Caspofungin,
color = MutatedAminoAcids,
label = ifelse((Micafungin > LabelCutOff & Caspofungin < origin) | (Micafungin < origin & Caspofungin > LabelCutOff), Sequence, ""))) +
geom_text(hjust = -0.1, vjust = -0.1) + geom_jitter()
title <- ggdraw() +
draw_label(
paste(sample, "_", gene, "-", hotspot,sep = ""),
fontface = 'bold',
x = 0,
hjust = 0
) +
theme(
# add margin on the left of the drawing canvas,
# so title is aligned with left edge of first plot
plot.margin = margin(0, 0, 0, 97)
)
#plot_grid(title, Graph1, Graph3, Graph2)
#ggsave(paste("pairPlot_", nameOfFile, ".png", sep = ""), width = 10, height = 10)
write.csv(BestData, paste("Data_pairPlot_", nameOfFile, ".csv", sep = ""), row.names=FALSE)
}
makeComparisonPlot("BY4741", "FKS1", "HS1")
makeComparisonPlot("BY4741", "FKS1", "HS2")
makeComparisonPlot("R1158", "FKS1", "HS1")
makeComparisonPlot("R1158", "FKS1", "HS2")
makeComparisonPlot("R1158", "FKS2", "HS1")
makeComparisonPlot("R1158", "FKS2", "HS2")
